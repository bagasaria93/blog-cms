<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Posts - Blog & Portfolio CMS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="assets/css/custom.css">
</head>
<body class="bg-gray-50">
    <div class="flex h-screen overflow-hidden">
        <aside class="w-64 bg-white shadow-lg flex-shrink-0">
            <div class="p-6 border-b border-gray-200">
                <div class="flex items-center space-x-3">
                    <div class="h-10 w-10 bg-gradient-to-br from-green-500 to-green-700 rounded-lg flex items-center justify-center">
                        <i data-lucide="layout-dashboard" class="w-6 h-6 text-white"></i>
                    </div>
                    <div>
                        <h1 class="text-lg font-bold text-gray-900">CMS Panel</h1>
                        <p class="text-xs text-gray-500">Content Management</p>
                    </div>
                </div>
            </div>
            
            <nav class="p-4 space-y-1">
                <a href="dashboard.html" class="sidebar-link">
                    <i data-lucide="layout-dashboard"></i>
                    <span>Dashboard</span>
                </a>
                <a href="posts.html" class="sidebar-link active">
                    <i data-lucide="file-text"></i>
                    <span>Blog Posts</span>
                </a>
                <a href="portfolio.html" class="sidebar-link">
                    <i data-lucide="briefcase"></i>
                    <span>Portfolio</span>
                </a>
                <a href="media.html" class="sidebar-link">
                    <i data-lucide="image"></i>
                    <span>Media Library</span>
                </a>
                <a href="settings.html" class="sidebar-link">
                    <i data-lucide="settings"></i>
                    <span>Settings</span>
                </a>
                <a href="#" onclick="logout()" class="sidebar-link text-red-600 hover:bg-red-50">
                    <i data-lucide="log-out"></i>
                    <span>Logout</span>
                </a>
            </nav>
        </aside>

        <div class="flex-1 flex flex-col overflow-hidden">
            <header class="bg-white shadow-sm z-10">
                <div class="px-6 py-4 flex items-center justify-between">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900">Blog Posts</h2>
                        <p class="text-sm text-gray-600">Manage your blog content</p>
                    </div>
                    <button onclick="openPostModal()" class="btn-primary">
                        <i data-lucide="plus" class="w-5 h-5"></i>
                        New Post
                    </button>
                </div>
            </header>

            <main class="flex-1 overflow-y-auto p-6">
                <div class="bg-white rounded-lg shadow-sm mb-6 p-4">
                    <div class="flex flex-wrap gap-4">
                        <div class="flex-1 min-w-[200px]">
                            <input type="text" id="searchInput" placeholder="Search posts..." 
                                   class="input-field" onkeyup="filterPosts()">
                        </div>
                        <div class="w-48">
                            <select id="categoryFilter" class="input-field" onchange="filterPosts()">
                                <option value="">All Categories</option>
                            </select>
                        </div>
                        <div class="w-40">
                            <select id="statusFilter" class="input-field" onchange="filterPosts()">
                                <option value="">All Status</option>
                                <option value="published">Published</option>
                                <option value="draft">Draft</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-sm">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Title</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200" id="postsTable">
                            </tbody>
                        </table>
                    </div>
                    <div class="px-6 py-4 border-t border-gray-200 flex items-center justify-between">
                        <div class="text-sm text-gray-600">
                            Showing <span id="showingStart">0</span> to <span id="showingEnd">0</span> of <span id="totalRecords">0</span> posts
                        </div>
                        <div class="flex space-x-2" id="pagination">
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <div id="postModal" class="modal">
        <div class="modal-content max-w-4xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-900" id="modalTitle">New Post</h3>
                <button onclick="closePostModal()" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            <form id="postForm" onsubmit="savePost(event)">
                <input type="hidden" id="postId">
                
                <div class="space-y-4">
                    <div>
                        <label class="label">Title</label>
                        <input type="text" id="postTitle" class="input-field" required>
                    </div>

                    <div>
                        <label class="label">Content</label>
                        <div class="mb-2 flex flex-wrap gap-2 border-b pb-2">
                            <button type="button" onclick="formatText('bold')" class="px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded text-sm font-semibold">B</button>
                            <button type="button" onclick="formatText('italic')" class="px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded text-sm italic">I</button>
                            <button type="button" onclick="formatText('heading')" class="px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded text-sm font-bold">H</button>
                            <button type="button" onclick="formatText('list')" class="px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded text-sm">List</button>
                            <button type="button" onclick="formatText('link')" class="px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded text-sm">Link</button>
                            <button type="button" onclick="formatText('image')" class="px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded text-sm">Image</button>
                        </div>
                        <textarea id="postContent" rows="10" class="input-field font-mono text-sm" required></textarea>
                    </div>

                    <div>
                        <label class="label">Excerpt</label>
                        <textarea id="postExcerpt" rows="3" class="input-field"></textarea>
                    </div>

                    <div>
                        <label class="label">Featured Image URL</label>
                        <input type="url" id="postImage" class="input-field" placeholder="https://images.unsplash.com/...">
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="label">Category</label>
                            <select id="postCategory" class="input-field" required>
                                <option value="">Select Category</option>
                                <option value="Technology">Technology</option>
                                <option value="Lifestyle">Lifestyle</option>
                                <option value="Business">Business</option>
                                <option value="Tutorial">Tutorial</option>
                                <option value="Design">Design</option>
                            </select>
                        </div>
                        <div>
                            <label class="label">Or Create New</label>
                            <input type="text" id="newCategory" class="input-field" placeholder="New category name">
                        </div>
                    </div>

                    <div>
                        <label class="label">Tags (comma separated)</label>
                        <input type="text" id="postTags" class="input-field" placeholder="javascript, react, web development">
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="label">Status</label>
                            <select id="postStatus" class="input-field" required>
                                <option value="draft">Draft</option>
                                <option value="published">Published</option>
                            </select>
                        </div>
                        <div>
                            <label class="label">Publish Date</label>
                            <input type="date" id="postDate" class="input-field" required>
                        </div>
                    </div>

                    <div class="border-t pt-4">
                        <h4 class="font-semibold text-gray-900 mb-3">SEO Settings</h4>
                        <div class="space-y-3">
                            <div>
                                <label class="label">Meta Title</label>
                                <input type="text" id="metaTitle" class="input-field" maxlength="60">
                                <p class="text-xs text-gray-500 mt-1">Recommended: 50-60 characters</p>
                            </div>
                            <div>
                                <label class="label">Meta Description</label>
                                <textarea id="metaDescription" rows="2" class="input-field" maxlength="160"></textarea>
                                <p class="text-xs text-gray-500 mt-1">Recommended: 150-160 characters</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-6 flex justify-between">
                    <button type="button" onclick="previewPost()" class="btn-secondary">
                        <i data-lucide="eye" class="w-5 h-5"></i>
                        Preview
                    </button>
                    <div class="flex space-x-3">
                        <button type="button" onclick="closePostModal()" class="btn-secondary">Cancel</button>
                        <button type="submit" class="btn-primary">
                            <i data-lucide="save" class="w-5 h-5"></i>
                            Save Post
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <div id="previewModal" class="modal">
        <div class="modal-content max-w-4xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-900">Preview</h3>
                <button onclick="closePreviewModal()" class="text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            <div id="previewContent" class="prose max-w-none">
            </div>
        </div>
    </div>

    <div id="deleteModal" class="modal">
        <div class="modal-content max-w-md">
            <div class="text-center">
                <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4">
                    <i data-lucide="alert-triangle" class="h-6 w-6 text-red-600"></i>
                </div>
                <h3 class="text-lg font-medium text-gray-900 mb-2">Delete Post</h3>
                <p class="text-sm text-gray-500 mb-6">Are you sure you want to delete this post? This action cannot be undone.</p>
                <div class="flex justify-center space-x-3">
                    <button onclick="closeDeleteModal()" class="btn-secondary">Cancel</button>
                    <button onclick="confirmDelete()" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

    <script src="data/sample-data.js"></script>
    <script src="assets/js/storage.js"></script>
    <script src="assets/js/utils.js"></script>
    <script src="assets/js/auth.js"></script>
    <script src="assets/js/posts.js"></script>
    <script>
        lucide.createIcons();
        checkAuth();
        loadPosts();
        populateCategoryFilter();
    </script>
</body>
</html>